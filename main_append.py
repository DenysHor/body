# -*- coding: utf-8 -*-
import gspread
from oauth2client.service_account import ServiceAccountCredentials

SERVICE_ACCOUNT_FILE = "gpt-body-parameters-ee1a7fa0b8b5.json"  # поклади свій JSON поруч
SHEET_ID = "1iWi6m3o2qatEyDTNXKqkqq_xQ3DacE_E7_NR162GNeI"

scope = ["https://spreadsheets.google.com/feeds",
         "https://www.googleapis.com/auth/drive"]
creds = ServiceAccountCredentials.from_json_keyfile_name(SERVICE_ACCOUNT_FILE, scope)
gc = gspread.authorize(creds)
sh = gc.open_by_key(SHEET_ID)

def upsert(title, headers, rows):
    try:
        ws = sh.worksheet(title)
    except gspread.exceptions.WorksheetNotFound:
        ws = sh.add_worksheet(title=title, rows=max(100, len(rows)+10), cols=len(headers))
    ws.clear()
    ws.update([headers] + rows, value_input_option="USER_ENTERED")

# ---- ЖУРНАЛ ----
journal_headers = ["Дата","Вага (кг)","ІМТ","Тілесний жир (%)","Скелетні м’язи (%)","Вода (%)",
                   "Білок (%)","Вісцеральний жир (рівень)","Кісткова маса (%)","BMR (ккал)",
                   "Фітнес-вік","Вага жиру (кг)","BFMI","FFM (кг)","Примітки"]
journal_rows = [
    ["2025-09-21",95.9,29.6,30.6,36.8,50.4,16.3,15,3.6,1808,51,29.4,7,66.6,"Стартові дані"],
    ["2025-09-22",95.6,29.5,29.8,37.2,51.0,16.4,14,3.7,1820,51,28.5,6,67.1,"Після тренування, другий замір"],
    ["2025-09-28",95.7,29.5,30.7,36.7,50.3,16.4,15,3.7,1802,51,29.4,7,66.3,"Ранковий замір"],
    ["2025-10-04",96.2,29.7,30.0,37.1,50.8,16.3,14,3.6,1824,51,28.9,6,67.3,"Ранковий замір"],
]

# ---- ХАРЧУВАННЯ ----
food_headers = ["Дата","Час","Прийом","Страва / Продукт","Кількість","Ккал","Білки (г)","Жири (г)","Вуглеводи (г)","Клітковина (г)","Позначка","Нотатка"]
food_rows = [
    ["2025-09-21","ранок","Сніданок","Сніданок (деталі не вказані)","-", "", "", "", "", "", "потребує уточнення","Перед сніданком — вода з лимоном"],
    ["2025-09-21","після тренування","Перекус","Банан","≈120 г",105,1.3,0.3,27,3.1,"оцінка",""],
    ["2025-09-21","вечір","Вечеря","Індичка (філе)","≈200 г",220,46,2,0,0,"оцінка","Теплий салат з індички"],
    ["2025-09-21","вечір","Вечеря","Овочі мікс","≈200 г",60,2,0.5,12,3,"оцінка",""],
    ["2025-09-21","вечір","Вечеря","Оливкова олія","1 ст. л. (15 мл)",120,0,14,0,0,"оцінка","у соусі"],
    ["2025-09-21","вечір","Вечеря","Кунжут","1 ч. л. (5 г)",29,1,2.6,1.3,1.1,"оцінка",""],
    ["2025-10-04","обід","Обід","Гречка варена","≈250 г",155,5.7,1.4,33,4.5,"оцінка","з цибулею, часником, овочами"],
    ["2025-10-04","обід","Обід","Овочі (цибуля, перець, морква)","≈150 г",45,1.5,0.2,10,2.0,"оцінка",""],
    ["2025-10-04","обід","Обід","Олія для обсмаження","1 ч. л. (5 мл)",45,0,5,0,0,"оцінка",""],
    ["2025-10-04","обід","Обід","Яловичина пісна 5%","≈150 г",250,26,15,0,0,"оцінка","уточнено"],
    ["2025-10-04","обід","Обід","Томатний сік","≈250 мл",45,2,0,10,1,"оцінка",""],
]

# ---- ПУЛЬС ----
pulse_headers = ["Дата","Діапазон (мін–макс, уд/хв)","Останнє вимірювання","Приклад низького","Приклад високого","Середній у спокої","Примітки"]
pulse_rows = [
    ["2025-09-28","53–91",62,59,89,57,"Ранковий замір"]
]

if __name__ == "__main__":
    upsert("Журнал", journal_headers, journal_rows)
    upsert("Харчування", food_headers, food_rows)
    upsert("Пульс", pulse_headers, pulse_rows)
    print("Готово: дані синхронізовано.")